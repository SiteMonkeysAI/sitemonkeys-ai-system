You are Claude, an AI assistant tasked with fixing issues in a GitHub repository.

Issue #443: [claude-fix] Issue #442: Response Intelligence - Fix All Remaining Test Failures

Issue Description:
<html>
<body>
<!--StartFragment--><html><head></head><body><h1>Issue #442: Response Intelligence - Fix All Remaining Test Failures</h1>
<h2>Problem Statement</h2>
<p>After PRs #439 and #441 (political guardrails regex fixes), <strong>4 critical test failures remain</strong>:</p>

Test | Current | Problem
-- | -- | --
Greetings | 0/3 (0%) | "Hello" returns 1,099 char biography instead of "Hello Chris!"
Engagement Bait | 1/2 (50%) | "25×4" returns 215 chars with false continuity claim
Permanent Facts | 5/6 (83%) | "One sentence only" constraint ignored
Overall | 81.3% | Target: >95%


<h3>Bible Principle</h3>
<p><strong>TECHNICAL_STANDARDS (lines 286-291) - Token Budget:</strong></p>
<blockquote>
<p>"Simple queries: 10,000 tokens max. Basic questions, definitions, explanations. No memory or document context needed."</p>
</blockquote>
<p>If token BUDGETS are lower for simple queries, response LENGTHS should be too.</p>
<hr>
<h2>Implementation Approach</h2>
<p>The system needs to answer ONE question before processing any query:</p>
<blockquote>
<p><strong>"What does this user actually NEED?"</strong></p>
</blockquote>
<p>For "Hello" → They need a warm greeting. That's it.
For "25×4" → They need "100". That's it.
For "Define X. One sentence." → They need one sentence. That's it.</p>
<p>This is the <strong>CEO vs Warehouse Worker</strong> principle:</p>
<ul>
<li>Warehouse Worker: "I have memory, so I'll inject it. I have context, so I'll add it."</li>
<li>CEO: "What does this user need? Give them exactly that."</li>
</ul>
<hr>
<h2>Success Criteria</h2>
<p><strong>This issue is NOT complete until ALL of these pass:</strong></p>
<pre><code>GREET-001 "Hello" → Response &lt; 100 chars, no biography ✓
GREET-002 "Hi there" → Response &lt; 100 chars ✓
GREET-003 "Howdy partner" → Response &lt; 100 chars ✓

EB-001 "What is 25 × 4?" → Response &lt; 50 chars, no false continuity ✓

PERM-002 "What does 'ubiquitous' mean? One sentence only." → 1 sentence, &lt; 200 chars ✓

Overall test pass rate: &gt; 95% ✓
</code></pre>
<p><strong>Partial implementations will be rejected.</strong> All 4 failure categories must be fixed.</p>
<hr>
<h2>Files Likely Involved</h2>
<p>Based on the architecture, these areas need attention:</p>
<ul>
<li>Query classification / response planning</li>
<li>Memory injection decision logic</li>
<li>Response post-processing / validation</li>
<li>Format constraint detection and enforcement</li>
</ul>
<p>The implementer should determine the exact files based on the current codebase structure.</p>
<hr>
<h2>What NOT To Do</h2>
<p>❌ Don't just add more regex patterns (that's warehouse worker thinking)
❌ Don't fix only one of the four failures
❌ Don't add padding or explanations to simple queries
❌ Don't inject memory when it adds no value</p>
<hr>
<h2>References</h2>
<ul>
<li><strong>MASTER_SPECIFICATION_01.docx</strong> - System architecture</li>
<li><strong>PRINCIPLES_AND_PHILOSOPHY_01.docx</strong> - Core principles (Efficiency as Respect, Truth First, Anti-Engagement)</li>
<li><strong>TECHNICAL_STANDARDS_01.docx</strong> - Token budgets, response validation</li>
<li><strong>Initial_Architectural_Rebuild_chat</strong> - CEO vs Warehouse Worker principle</li>
</ul>
<hr>
<p><strong>Priority:</strong> CRITICAL<br>
<strong>Blocking:</strong> User experience fundamentally broken for simple interactions<br>
<strong>Definition of Done:</strong> All success criteria pass, overall test rate &gt;95%</p></body></html><!--EndFragment-->
</body>
</html>
Your task is to:
1. Analyze the issue carefully to understand the problem
2. Look through the repository to identify the relevant files that need to be modified
3. Make precise changes to fix the issue
4. Use the Edit tool to modify files directly when needed
5. Be minimal in your changes - only modify what's necessary to fix the issue

After making changes, provide a summary of what you did in this format:

---SUMMARY---
[Your detailed summary of changes, including which files were modified and how]
---END SUMMARY---

Remember:
- Be specific in your changes
- Only modify files that are necessary to fix the issue
- Follow existing code style and conventions
- Make the minimal changes needed to resolve the issue
