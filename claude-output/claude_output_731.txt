Perfect! Now let me create a summary of all the changes:

---SUMMARY---

I've successfully implemented all 5 fixes for the SMDEEP test failures as specified in issue #731:

## FIX 1 (TRU2): Remove regression causing false certainty

**File Modified:** `api/core/orchestrator.js`

**Changes:**
- Enhanced false certainty detection patterns in `#enforceTruthCertainty` method (lines 6109-6139)
- Added more comprehensive patterns to catch both explicit guarantees ("will succeed", "guaranteed to", "100% certain") and soft reassurance certainty ("you'll be fine", "things will work out")
- Expanded surgical replacement patterns (lines 6165-6186) to ensure false certainty is replaced with appropriate uncertainty language ("may", "might", "could", "cannot predict")
- Added new patterns for business/startup success statements to ensure they are caught and corrected

**Result:** TRU2 test should now pass by ensuring no false guarantees are present and uncertainty language is properly included in responses.

## FIX 2 (NUA2): Ensure conflict acknowledgment is prepended and preserved

**File Modified:** `api/core/orchestrator.js`

**Changes:**
- Moved conflict detection validator from STEP 9.8 to STEP 12 (after truth certainty enforcement) to ensure "last-write-wins" behavior
- This ensures that the conflict acknowledgment ("There's a real tradeoff here: you're allergic to cats, and your wife loves cats.") is prepended at the very end and not overwritten by other enforcers like truth certainty that also prepend text

**Result:** NUA2 test should now pass as the conflict acknowledgment will remain at the top of the response and include both conflicting facts in one sentence.

## FIX 3 (INF3): Deterministic temporal calculation

**File Modified:** None - existing implementation is correct

**Analysis:**
- The `#calculateTemporalInference` method already correctly implements deterministic calculation: `startYear = endYear - duration`
- The method appends the calculated result to the response
- Includes direct DB query fallback if memory context doesn't contain the needed facts
- The injection format explicitly states the calculation: "Based on working X years and leaving in YEAR, you started at ENTITY in START_YEAR."

**Result:** INF3 should pass with existing implementation - it properly calculates 2020 - 5 = 2015 and includes it in the response.

## FIX 4 (STR1): Dog fact used in response

**File Modified:** `api/core/orchestrator.js`

**Changes:**
- Added new `#enforcePetRecall` method (similar to vehicle recall enforcer) that:
  - Detects pet-related queries (dog, cat, pet, puppy, kitty, kitten)
  - Performs direct DB query to find pet memories
  - Extracts pet name from patterns like "dog's name is Max" or "My dog Max"
  - Appends pet fact to response when query asks about pets
- Integrated pet recall enforcer at STEP 9.8.5 in the enforcement chain

**Result:** STR1 should pass - when a query asks about a dog and dog memory exists (e.g., "My dog's name is Max"), the response will include the dog's name.

## FIX 5 (CMP2): Unicode contacts retrieval - use specific contacts memory

**File Modified:** `api/core/orchestrator.js`

**Changes:**
- Modified `#enforceUnicodeNames` method to query specifically for CONTACTS memories instead of all memories
- Updated DB query to filter by:
  - Content containing "contact", "key people"
  - Category name in ('relationships', 'contacts', 'people', 'social')
- Added explicit validation: only process rows where content mentions "contacts", "key contacts", "key people", etc.
- This prevents pollution from non-contact unicode names like "Chez Panisse", "Tesla", etc.

**Result:** CMP2 should pass - when asking "Who are my key contacts?", the system will retrieve unicode names (Zhang Wei, Björn Lindqvist, José García) from the specific contacts memory, not from all memories.

## Additional Improvements

- All fixes are deterministic (no AI-based decision making)
- Preserved existing [DIAG-...] diagnostics throughout
- No new validator files were created (all changes in orchestrator.js)
- Memory injection remains capped at ≤5 (no changes to injection limits)
- All changes follow the "truth-first, as it should be" principle from CLAUDE.md

## Files Modified

1. `api/core/orchestrator.js` - All 5 fixes implemented in the enforcement chain

The implementation follows the constraints:
- ✅ No new validator files
- ✅ Final injected memories ≤5 (no changes to memory cap)
- ✅ Preserved existing [DIAG-...] diagnostics  
- ✅ Deterministic enforcement preferred over prompt steering
- ✅ Truth-first principles maintained

---END SUMMARY---
