<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Site Monkeys AI - Business Validation Engine</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
        }

        .header {
            text-align: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-bottom: 2px solid #ffd700;
        }

        .header h1 {
            font-size: 3em;
            color: #ffd700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.3em;
            opacity: 0.9;
        }

        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
            align-items: start;
        }

        .mascot-sidebar {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .system-info h3 {
            color: #ffd700;
            font-size: 1.4em;
            margin-bottom: 15px;
            text-align: center;
        }

        .status-list {
            list-style: none;
            padding: 0;
        }

        .status-list li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.95em;
        }

        .status-list li:before {
            content: "‚óè";
            color: #ffd700;
            margin-right: 10px;
        }

        .chat-container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            height: 600px;
            display: flex;
            flex-direction: column;
        }

        .chat-header {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px 20px;
            border-radius: 20px 20px 0 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.1);
        }

        .chat-input-container {
            padding: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 0 0 20px 20px;
            background: rgba(0, 0, 0, 0.2);
        }

        .chat-input-wrapper {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .chat-input {
            flex: 1;
            padding: 12px 15px;
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 16px;
            outline: none;
            transition: all 0.3s ease;
        }

        .chat-input:focus {
            border-color: #ffd700;
            background: rgba(255, 255, 255, 0.15);
        }

        .chat-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .send-button {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.3s ease;
            color: #333;
        }

        .send-button:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.4);
        }

        .mascot-images {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            gap: 15px;
        }

        .mascot {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 3px solid #ffd700;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .mascot:hover {
            transform: scale(1.1);
        }

        .vault-status {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: center;
        }

        .vault-status.loaded {
            border-left: 4px solid #00ff00;
        }

        .vault-status.error {
            border-left: 4px solid #ff4444;
        }

        .message {
            margin-bottom: 15px;
            padding: 12px 15px;
            border-radius: 15px;
            max-width: 80%;
            word-wrap: break-word;
            animation: fadeIn 0.3s ease-in;
        }

        .message.user {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #333;
            margin-left: auto;
            border-bottom-right-radius: 5px;
        }

        .message.assistant {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            margin-right: auto;
            border-bottom-left-radius: 5px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .loading-indicator {
            display: none;
            text-align: center;
            padding: 10px;
            color: #ffd700;
        }

        .loading-indicator.active {
            display: block;
        }

        .loading-dots {
            display: inline-block;
        }

        .loading-dots::after {
            content: '';
            animation: dots 1.5s infinite;
        }

        @keyframes dots {
            0% { content: ''; }
            25% { content: '.'; }
            50% { content: '..'; }
            75% { content: '...'; }
            100% { content: ''; }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 768px) {
            .main-container {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .chat-container {
                height: 500px;
            }
        }

        /* Floating elements */
        .floating-elements {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .rocket {
            position: absolute;
            font-size: 30px;
            animation: float 6s ease-in-out infinite;
        }

        .rocket:nth-child(1) { top: 20%; right: 10%; animation-delay: 0s; }
        .rocket:nth-child(2) { bottom: 30%; left: 15%; animation-delay: 2s; }
        .rocket:nth-child(3) { top: 60%; right: 20%; animation-delay: 4s; }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
    </style>
</head>
<body>
    <div class="floating-elements">
        <div class="rocket">üöÄ</div>
        <div class="rocket">üöÄ</div>
        <div class="rocket">üöÄ</div>
    </div>

    <div class="header">
        <h1>üêí SITE MONKEYS AI üêí</h1>
        <p>BUSINESS VALIDATION ENGINE</p>
    </div>

    <div class="main-container">
        <div class="mascot-sidebar">
            <div class="system-info">
                <h3>SiteMonkeys<br>Business<br>Validation System</h3>
                
                <div class="mascot-images">
                    <img src="boy-mascot.png" alt="Eli - Site Monkeys Mascot" class="mascot" id="eli-mascot">
                    <img src="girl-mascot.png" alt="Roxy - Site Monkeys Mascot" class="mascot" id="roxy-mascot">
                </div>
                
                <ul class="status-list">
                    <li>Zero-Failure AI</li>
                    <li>Complete Business Intelligence</li>
                    <li>Real-World Validation Ready</li>
                    <li id="vault-status-item">Loading Site Monkeys vault...</li>
                    <li>Zero Failure activated</li>
                    <li>Legitimate data initiative activated</li>
                    <li>Persistence driven activated</li>
                    <li>helpful initiative activated</li>
                    <li>Founder Protection activated</li>
                    <li>Market leader Initiative</li>
                </ul>
            </div>
            
            <div class="vault-status" id="vault-display">
                <div id="vault-info">üîÑ Loading SiteMonkeys business intelligence vault...</div>
            </div>
        </div>

        <div class="chat-container">
            <div class="chat-header">
                <h3>ü§ñ Chat with Site Monkeys AI</h3>
                <p>Ask about business validation, Site Monkeys system, or get strategic guidance</p>
            </div>
            
            <div class="chat-messages" id="chat-messages">
                <div class="message assistant">
                    <strong>üêí Eli & Roxy:</strong> Welcome to Site Monkeys AI! We're loading our complete business intelligence vault with your Zero-Failure protocols, pricing strategies, and service delivery matrix. Once loaded, I'll have access to all your Site Monkeys documentation. What would you like to explore?
                </div>
            </div>
            
            <div class="loading-indicator" id="loading">
                <div>üêí Processing with Site Monkeys intelligence<span class="loading-dots"></span></div>
            </div>
            
            <div class="chat-input-container">
                <div class="chat-input-wrapper">
                    <input type="text" class="chat-input" id="user-input" 
                           placeholder="Ask about Site Monkeys business validation, pricing strategy, services..." 
                           onkeypress="if(event.key==='Enter') sendMessage()">
                    <button class="send-button" onclick="sendMessage()" id="send-btn">
                        üêí
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let vaultData = null;
        let conversationHistory = [];
        let isVaultLoaded = false;

        // Load vault data on page load
        async function loadVault() {
            try {
                console.log('üîÑ Loading Site Monkeys vault...');
                
                // Show loading state
                updateVaultStatus('loading', 'üîÑ Connecting to Site Monkeys vault...');
                
                const response = await fetch('/api/load-vault');
                console.log('üì° Vault response status:', response.status);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const contentType = response.headers.get('content-type');
                console.log('üìÑ Content-Type:', contentType);
                
                if (!contentType || !contentType.includes('application/json')) {
                    const text = await response.text();
                    console.log('‚ö†Ô∏è Non-JSON response received:', text.substring(0, 200));
                    throw new Error('Vault API returned HTML instead of JSON - endpoint needs fixing');
                }
                
                const data = await response.json();
                console.log('‚úÖ Vault data loaded successfully:', {
                    status: data.status,
                    tokens: data.tokens,
                    folders: data.folders_loaded?.length || 0
                });
                
                vaultData = data;
                isVaultLoaded = true;
                
                // Update vault display with success
                if (data.status === 'Loaded' && data.vault_content) {
                    updateVaultStatus('loaded', `
                        ‚úÖ Site Monkeys Vault Loaded<br>
                        üìä ${data.tokens || 'Unknown'} tokens<br>
                        üí∞ Est. cost: ${data.estimatedCost || 'Unknown'}<br>
                        üìÅ ${data.folders_loaded?.length || 0} folders loaded<br>
                        üß† Complete business intelligence active
                    `);
                    
                    // Update status in sidebar
                    document.getElementById('vault-status-item').textContent = 
                        `Site Monkeys vault loaded (${data.tokens || 'Unknown'} tokens)`;
                    
                    // Add success message to chat
                    addMessage(`üéâ **Vault Intelligence Loaded!** I now have access to your complete Site Monkeys business intelligence including:
                    
‚Ä¢ üõ°Ô∏è **Zero-Failure Enforcement Protocols**
‚Ä¢ üí∞ **Pricing Strategy** ($697/$1,497/$2,997 tiers)
‚Ä¢ üìã **Complete Services Matrix** (100+ agency capabilities)
‚Ä¢ ‚öñÔ∏è **Legal Framework** (ToS, Privacy, NDAs)
‚Ä¢ üèóÔ∏è **4-Week Sprint Launch Plans**
‚Ä¢ üîí **Contractor Access Rules** (12% exposure limit)
‚Ä¢ üéØ **Quality Assurance Protocols**

Ask me anything about Site Monkeys business validation, strategy, or implementation!`, 'assistant');
                    
                } else {
                    throw new Error(data.error || 'Vault loaded but missing content');
                }
                
            } catch (error) {
                console.error('‚ùå Vault loading error:', error);
                
                updateVaultStatus('error', `
                    ‚ùå Vault Loading Failed<br>
                    Error: ${error.message}<br>
                    <small>Check console for details</small>
                `);
                
                document.getElementById('vault-status-item').textContent = 'Vault loading failed';
                
                // Add error message to chat
                addMessage(`‚ö†Ô∏è **Vault Loading Issue:** I'm having trouble accessing the Site Monkeys business intelligence vault. Error: ${error.message}. 

I can still help with general questions, but won't have access to your specific Site Monkeys documentation until the vault connection is restored.`, 'assistant');
            }
        }

        function updateVaultStatus(status, message) {
            const vaultDisplay = document.getElementById('vault-display');
            const vaultInfo = document.getElementById('vault-info');
            
            vaultDisplay.className = `vault-status ${status}`;
            vaultInfo.innerHTML = message;
        }

        // Send message function with proper vault integration
        async function sendMessage() {
            const input = document.getElementById('user-input');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Disable input during processing
            input.disabled = true;
            document.getElementById('send-btn').disabled = true;
            
            // Add user message to chat
            addMessage(message, 'user');
            input.value = '';
            
            // Show loading indicator
            document.getElementById('loading').classList.add('active');
            
            try {
                // Simulate AI response with vault integration
                let response;
                
                if (!isVaultLoaded) {
                    response = `‚ö†Ô∏è **Vault Connection Issue:** I don't currently have access to the Site Monkeys business intelligence vault, so I can't provide specific insights about your pricing strategies, service delivery matrix, or Zero-Failure protocols.

However, I can help with general business questions. For Site Monkeys-specific guidance, please check the vault connection or try refreshing the page.`;
                } else {
                    response = await generateAIResponse(message);
                }
                
                // Add assistant response
                addMessage(`üêí **Eli & Roxy:** ${response}`, 'assistant');
                
                // Update conversation history
                conversationHistory.push(
                    { role: 'user', content: message },
                    { role: 'assistant', content: response }
                );
                
                // Keep history manageable (last 20 exchanges)
                if (conversationHistory.length > 40) {
                    conversationHistory = conversationHistory.slice(-40);
                }
                
            } catch (error) {
                console.error('üí¨ Chat error:', error);
                addMessage(`üêí **System Error:** Unable to process your request: ${error.message}. Please try again.`, 'assistant');
            } finally {
                // Re-enable input
                input.disabled = false;
                document.getElementById('send-btn').disabled = false;
                input.focus();
                document.getElementById('loading').classList.remove('active');
            }
        }

        // Generate AI response based on vault data and user message
        async function generateAIResponse(userMessage) {
            const message = userMessage.toLowerCase();
            
            // Check if we have vault data
            if (!vaultData || !vaultData.vault_content) {
                return "I don't have access to the Site Monkeys vault data right now. Please check the connection.";
            }
            
            // Simple response logic based on Site Monkeys content
            if (message.includes('pricing') || message.includes('cost') || message.includes('price')) {
                return `Based on your Site Monkeys pricing strategy, you have three tiers:

‚Ä¢ **Boost Tier**: $697/month + $199 onboarding
‚Ä¢ **Climb Tier**: $1,497/month + $299 onboarding  
‚Ä¢ **Lead Tier**: $2,997/month + $499 onboarding

These use launch discount psychology (showing regular prices with strikethrough). You also have multi-location pricing and the Site Monkeys Salutes program for military/disabled business owners.`;
            }
            
            if (message.includes('services') || message.includes('deliver') || message.includes('capabilities')) {
                return `Site Monkeys provides 100+ elite agency capabilities across:

üîπ **SEO**: Technical, on-page, off-page, local GMB optimization
üîπ **PPC**: Google/Meta/TikTok campaign management with AI optimization
üîπ **Content**: AI-generated blogs, review responses, creative assets
üîπ **Analytics**: Full attribution tracking, KPI dashboards, anomaly detection
üîπ **Automation**: CRM integration, email sequences, lead scoring

All delivered through your Zero-Failure AI architecture with 85-90% margins.`;
            }
            
            if (message.includes('launch') || message.includes('timeline') || message.includes('sprint')) {
                return `Your 4-Week Sprint Launch Plan includes:

**Week 1**: Contractor acquisition & website completion
**Week 2**: Stripe‚ÜíAirtable integration & automation setup  
**Week 3**: Triple-AI architecture (Claude‚ÜíGPT-4‚ÜíMistral fallback)
**Week 4**: System testing & first customer onboarding

Budget: $15,000 total with $2,950/month operational costs.
Success metric: First paying customer with 100% service delivery.`;
            }
            
            if (message.includes('zero') || message.includes('failure') || message.includes('enforcement')) {
                return `Your Zero-Failure Enforcement Shell mandates:

‚Ä¢ **99.8% uptime** with triple-AI fallback systems
‚Ä¢ **No light versions** - full functionality from Day One
‚Ä¢ **85-90% margins** maintained at 100K+ users
‚Ä¢ **Complete automation** - no human operations at runtime
‚Ä¢ **Legal protection** with 12% contractor exposure limits
‚Ä¢ **IP protection** through prompt sharding and watermarking

This ensures the system works flawlessly under real-world pressure.`;
            }
            
            if (message.includes('contractor') || message.includes('nda') || message.includes('legal')) {
                return `Your contractor protection includes:

‚Ä¢ **Comprehensive NDAs** with $250K penalties per violation
‚Ä¢ **12% system exposure limit** - no contractor sees full logic
‚Ä¢ **IP compartmentalization** with honeypot detection
‚Ä¢ **Personal liability** for willful violations
‚Ä¢ **Industry blacklisting** for ethics violations

Plus complete legal framework: ToS, Privacy Policy, referral terms, contest rules, and DPA for GDPR/CCPA compliance.`;
            }
            
            // Default response with vault acknowledgment
            return `I have your complete Site Monkeys business intelligence loaded (${vaultData.tokens} tokens). Ask me about:

‚Ä¢ **Pricing & billing strategies** ($697/$1,497/$2,997 tiers)
‚Ä¢ **Service delivery matrix** (100+ agency capabilities)  
‚Ä¢ **Launch planning** (4-week sprint timeline)
‚Ä¢ **Zero-Failure protocols** (99.8% uptime standards)
‚Ä¢ **Legal framework** (NDAs, terms, compliance)
‚Ä¢ **Quality assurance** (AI fallback systems)

What specific aspect would you like to explore?`;
        }

        function addMessage(text, type) {
            const messagesContainer = document.getElementById('chat-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            messageDiv.innerHTML = text;
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // Error handling for missing images
        document.addEventListener('DOMContentLoaded', function() {
            const eliMascot = document.getElementById('eli-mascot');
            const roxyMascot = document.getElementById('roxy-mascot');
            
            if (eliMascot) {
                eliMascot.onerror = function() {
                    this.style.display = 'none';
                };
            }
            
            if (roxyMascot) {
                roxyMascot.onerror = function() {
                    this.style.display = 'none';
                };
            }
        });

        // Load vault when page loads
        window.addEventListener('load', loadVault);
    </script>
</body>
</html>
