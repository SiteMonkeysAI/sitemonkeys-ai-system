<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SiteMonkeys AI - Business Validation System</title>
    
    <!-- PWA META TAGS FOR MOBILE APP EXPERIENCE -->
    <meta name="theme-color" content="#1a1a2e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="SiteMonkeys AI">
    
    <!-- APP ICONS -->
    <link rel="apple-touch-icon" href="/Apple Touch icon Site monkeys.png">
    <link rel="icon" href="/logo.png">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0c0c1d 0%, #1a1a2e 50%, #16213e 100%);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        
        /* ANIMATED STARS BACKGROUND */
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
        }
        
        /* MAIN CONTAINER */
        .container {
            position: relative;
            z-index: 10;
            min-height: 100vh;
            display: grid;
            grid-template-columns: 200px 1fr 200px;
            grid-template-rows: auto 1fr;
            gap: 20px;
            padding: 20px;
        }
        
        /* MOBILE RESPONSIVE */
        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto 1fr auto;
                gap: 15px;
                padding: 10px;
            }
            
            .mascot-left, .mascot-right {
                justify-self: center;
                grid-row: 2;
            }
            
            .mascot-right {
                grid-row: 4;
            }
        }
        
        /* HEADER */
        .header {
            grid-column: 1 / -1;
            text-align: center;
            padding: 20px;
            background: linear-gradient(45deg, #000 0%, #1a1a2e 100%);
            border: 2px solid #ffd700;
            border-radius: 15px;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 215, 0, 0.1), transparent);
            animation: shine 3s infinite;
        }
        
        @keyframes shine {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .logo-container {
            position: relative;
            z-index: 2;
            margin-bottom: 10px;
        }
        
        .logo {
            width: 60px;
            height: 60px;
            margin: 0 auto 10px;
            display: block;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
        }
        
        .title {
            font-size: clamp(24px, 5vw, 36px);
            color: #ffd700;
            font-weight: bold;
            margin-bottom: 5px;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        
        .subtitle {
            font-size: clamp(14px, 3vw, 18px);
            color: #ccc;
        }
        
        /* MASCOTS */
        .mascot-left, .mascot-right {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        
        .mascot-img {
            width: 120px;
            height: 120px;
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
            margin-bottom: 10px;
            transition: transform 0.3s ease;
        }
        
        .mascot-img:hover {
            transform: scale(1.1) rotate(5deg);
        }
        
        .mascot-name {
            font-size: 18px;
            color: #ffd700;
            font-weight: bold;
        }
        
        /* STATUS PANEL */
        .status-panel {
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid #333;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }
        
        .status-title {
            color: #ffd700;
            font-size: 16px;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .status-item {
            margin: 8px 0;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .status-icon {
            font-size: 16px;
        }
        
        /* MAIN CHAT AREA */
        .main-area {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            color: #333;
            display: flex;
            flex-direction: column;
            min-height: 400px;
            backdrop-filter: blur(10px);
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.2);
        }
        
        .chat-header {
            text-align: center;
            margin-bottom: 20px;
            color: #1a1a2e;
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 20px;
            max-height: 300px;
            padding: 10px;
            background: rgba(240, 240, 240, 0.5);
            border-radius: 10px;
        }
        
        .message {
            margin: 15px 0;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }
        
        .message-avatar {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            flex-shrink: 0;
        }
        
        .message-content {
            background: white;
            padding: 10px 15px;
            border-radius: 15px;
            border: 1px solid #ddd;
            flex: 1;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .input-area {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .chat-input {
            flex: 1;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 25px;
            font-size: 16px;
            outline: none;
            transition: border-color 0.3s ease;
        }
        
        .chat-input:focus {
            border-color: #ffd700;
        }
        
        .send-btn {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #1a1a2e;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .send-btn:hover {
            transform: scale(1.05);
        }
        
        .send-btn:active {
            transform: scale(0.95);
        }
        
        /* LOADING ANIMATION */
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            color: #666;
        }
        
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #ffd700;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* FLOATING ROCKETS */
        .rocket {
            position: fixed;
            width: 30px;
            height: 30px;
            pointer-events: none;
            z-index: 5;
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-20px) rotate(5deg); }
            50% { transform: translateY(-10px) rotate(-5deg); }
            75% { transform: translateY(-15px) rotate(3deg); }
        }
        
        /* COST TRACKING */
        .cost-tracker {
            font-size: 12px;
            color: #666;
            text-align: center;
            margin-top: 10px;
        }
        
        /* MOBILE OPTIMIZATIONS */
        @media (max-width: 480px) {
            .mascot-img {
                width: 80px;
                height: 80px;
            }
            
            .main-area {
                min-height: 300px;
            }
            
            .chat-messages {
                max-height: 200px;
            }
        }
    </style>
</head>
<body>
    <!-- ANIMATED STARS -->
    <div class="stars" id="stars"></div>
    
    <!-- FLOATING ROCKETS -->
    <div class="rocket" style="top: 10%; left: 10%; animation-delay: 0s;">🚀</div>
    <div class="rocket" style="top: 30%; right: 15%; animation-delay: 2s;">🚀</div>
    <div class="rocket" style="bottom: 20%; left: 20%; animation-delay: 4s;">🚀</div>
    
    <div class="container">
        <!-- HEADER -->
        <header class="header">
            <div class="logo-container">
                <img src="/logo.png" alt="SiteMonkeys Logo" class="logo" onerror="this.style.display='none'">
            </div>
            <div class="title">🚀 SITE MONKEYS AI 🚀</div>
            <div class="subtitle">Business Validation System</div>
        </header>
        
        <!-- LEFT MASCOT - ELI -->
        <div class="mascot-left">
            <img src="/boy-mascot.png" alt="Eli" class="mascot-img" onerror="this.innerHTML='🐒'">
            <div class="mascot-name">ELI</div>
            
            <!-- STATUS PANEL -->
            <div class="status-panel">
                <div class="status-title">🔐 VAULT STATUS</div>
                <div class="status-item">
                    <span class="status-icon">✅</span>
                    <span id="vaultStatus">Loading...</span>
                </div>
                <div class="status-item">
                    <span class="status-icon">🧠</span>
                    <span id="tokensLoaded">Calculating...</span>
                </div>
                <div class="status-item">
                    <span class="status-icon">💰</span>
                    <span>Budget: $15K</span>
                </div>
                <div class="status-item">
                    <span class="status-icon">🔥</span>
                    <span>Burn: <$3K/mo</span>
                </div>
                <div class="status-item">
                    <span class="status-icon">📈</span>
                    <span>Margins: 87%+</span>
                </div>
            </div>
        </div>
        
        <!-- MAIN CHAT AREA -->
        <main class="main-area">
            <div class="chat-header">
                <h2>🎯 Business Validation Console</h2>
                <p>Your AI-powered strategic advisor</p>
            </div>
            
            <div class="chat-messages" id="chatMessages">
                <div class="message">
                    <img src="/logo.png" alt="System" class="message-avatar" onerror="this.innerHTML='🤖'">
                    <div class="message-content">
                        <strong>SiteMonkeys AI:</strong> <span id="welcomeMessage">Initializing business intelligence vault...</span>
                    </div>
                </div>
            </div>
            
            <div class="loading" id="loading">
                <div class="spinner"></div> Processing your request...
            </div>
            
            <div class="input-area">
                <input type="text" class="chat-input" id="chatInput" placeholder="Ask about your business strategy, financials, or launch preparation..." maxlength="500">
                <button class="send-btn" id="sendBtn">
                    🚀 LAUNCH
                </button>
            </div>
            
            <div class="cost-tracker">
                <span id="costTracker">API Calls: 0 | Estimated Cost: $0.00</span>
            </div>
        </main>
        
        <!-- RIGHT MASCOT - ROXY -->
        <div class="mascot-right">
            <img src="/girl-mascot.png" alt="Roxy" class="mascot-img" onerror="this.innerHTML='🐵'">
            <div class="mascot-name">ROXY</div>
            
            <!-- SYSTEM STATUS -->
            <div class="status-panel">
                <div class="status-title">⚡ SYSTEM STATUS</div>
                <div class="status-item">
                    <span class="status-icon">🌐</span>
                    <span>API: Online</span>
                </div>
                <div class="status-item">
                    <span class="status-icon">🔄</span>
                    <span>Auto-Sync: Active</span>
                </div>
                <div class="status-item">
                    <span class="status-icon">🛡️</span>
                    <span>Security: Enabled</span>
                </div>
                <div class="status-item">
                    <span class="status-icon">📱</span>
                    <span>Mobile: Ready</span>
                </div>
                <div class="status-item">
                    <span class="status-icon">🚀</span>
                    <span>Zero-Failure: Active</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        let messageCount = 0;
        let apiCost = 0;
        
        // CREATE ANIMATED STARS
        function createStars() {
            const starsContainer = document.getElementById('stars');
            for (let i = 0; i < 50; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.width = star.style.height = Math.random() * 3 + 1 + 'px';
                star.style.animationDelay = Math.random() * 3 + 's';
                starsContainer.appendChild(star);
            }
        }
        
        // LOAD VAULT DATA
        async function loadVault() {
            try {
                const response = await fetch('/api/load-vault');
                const data = await response.json();
                
                // Update status
                document.getElementById('vaultStatus').textContent = 'Vault Loaded ✅';
                document.getElementById('tokensLoaded').textContent = `${data.tokens} tokens loaded`;
                
                // Update welcome message
                const welcomeMsg = `Welcome to the SiteMonkeys Business Validation System! I have your complete vault loaded with financial constraints ($15K budget, $3K burn, 87% margins), pricing tiers ($697/$1,497/$2,997), legal framework, and zero-failure protocols. Ready to validate your launch preparation and transform your business strategy!`;
                document.getElementById('welcomeMessage').textContent = welcomeMsg;
                
            } catch (error) {
                console.error('Vault loading error:', error);
                document.getElementById('vaultStatus').textContent = 'Vault Error ❌';
                document.getElementById('welcomeMessage').textContent = 'System initializing... Please refresh if issues persist.';
            }
        }
        
        // SEND MESSAGE
        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message
            addMessage(message, 'user');
            input.value = '';
            
            // Show loading
            document.getElementById('loading').style.display = 'block';
            
            try {
                // Simulate AI response (replace with actual API call)
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                const responses = [
                    "Based on your $15K launch budget and $3K monthly burn rate, I recommend prioritizing the 4-week sprint implementation to achieve breakeven by month 3.",
                    "Your 87% margin target is achievable with the current pricing structure. The $697-$2,997 tiers provide optimal market positioning.",
                    "The zero-failure protocols are operational. All legal frameworks including NDAs and compliance measures are properly configured.",
                    "Your vault contains complete business intelligence. Financial constraints, pricing strategy, and implementation roadmap are all accessible.",
                    "The Site Monkeys platform is designed for scalability. Current architecture supports 100K+ customers without human runtime dependencies."
                ];
                
                const response = responses[Math.floor(Math.random() * responses.length)];
                
                // Add AI response
                addMessage(response, 'ai');
                
                // Update cost tracking
                messageCount++;
                apiCost += 0.02;
                document.getElementById('costTracker').textContent = `API Calls: ${messageCount} | Estimated Cost: $${apiCost.toFixed(2)}`;
                
            } catch (error) {
                addMessage('System temporarily unavailable. Please try again.', 'error');
            } finally {
                document.getElementById('loading').style.display = 'none';
            }
        }
        
        // ADD MESSAGE TO CHAT
        function addMessage(text, type) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message';
            
            let avatar, sender;
            if (type === 'user') {
                avatar = '👤';
                sender = 'You';
            } else if (type === 'ai') {
                avatar = messageCount % 2 === 0 ? '/boy-mascot.png' : '/girl-mascot.png';
                sender = messageCount % 2 === 0 ? 'Eli' : 'Roxy';
            } else {
                avatar = '⚠️';
                sender = 'System';
            }
            
            messageDiv.innerHTML = `
                <img src="${avatar}" alt="${sender}" class="message-avatar" onerror="this.innerHTML='🤖'">
                <div class="message-content">
                    <strong>${sender}:</strong> ${text}
                </div>
            `;
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
        
        // EVENT LISTENERS
        document.getElementById('sendBtn').addEventListener('click', sendMessage);
        document.getElementById('chatInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });
        
        // INITIALIZE
        document.addEventListener('DOMContentLoaded', function() {
            createStars();
            loadVault();
        });
        
        // PWA SERVICE WORKER REGISTRATION
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js').catch(console.error);
        }
    </script>
</body>
</html>
